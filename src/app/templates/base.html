<!doctype html>
<html lang="{{ lang|default('ru') }}">
<head>
  <meta charset="utf-8"/>
  <title>{% block title %}bona-plus{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- ===== SEO BASICS ===== -->
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- ===== OPEN GRAPH ===== -->
  <meta property="og:title" content="">
  <meta property="og:description" content="">
  <meta property="og:image" content="/static/img/logo.png">
  <meta property="og:type" content="website">
  <meta property="og:url" content="">

  <!-- ===== TWITTER CARDS ===== -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="/static/img/logo.png">

  <!-- ===== CANONICAL & HREFLANG ===== -->
  <link rel="canonical" href="">
  <link rel="alternate" href="" hreflang="ru">
  <link rel="alternate" href="" hreflang="en">

  <!-- Стили -->
  <link href="/static/css/base.css" rel="stylesheet"/>
  <link rel="icon" type="image/png" sizes="512x512" href="/static/img/favicon.png">
  {% block extra_head %}{% endblock %}
</head>
<body>
  <!-- ===== LANG MODAL ===== -->
  <div id="lang-wait" class="modal hidden">
    <div class="modal__content">
      <p>Перевод страницы, пожалуйста подождите…</p>
    </div>
  </div>

  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <h1 class="logo-text">AI assistent</h1>
        <img src="/static/img/logo.png" alt="logo" class="logo-img">
      </div>

      <nav class="main-nav" id="mainNav">
        <!-- User actions -->
        {% if user %}
          <span class="username">{{ username }}</span>
          <a href="/profile" class="btn">Профиль</a>
          <a href="javascript:void(0)" class="btn" id="logout-btn">Выйти</a>
        {% else %}
          <a href="javascript:void(0)" class="btn btn-login"
             onclick="document.getElementById('login-modal').classList.remove('hidden')">
            Войти / Регистрация
          </a>
        {% endif %}
      </nav>

      <div class="menu-toggle" id="menuToggle">☰</div>
    </div>
  </header>
  <!-- ===== END HEADER ===== -->

  <!-- ===== MAIN ===== -->
  <main class="site-main">
    {% block content %}{% endblock %}
  </main>

  <!-- ===== FLOATING TELEGRAM ===== -->
  <div class="telegram-float">
    <a href="https://t.me/assistent_next" target="_blank" rel="noopener">
      <img src="/static/img/telegram.svg" alt="Telegram">
    </a>
  </div>

  <!-- ===== FLOATING I18N TOGGLE ===== -->
  <div id="i18n-toggle">
    EN
  </div>

  <!-- ===== FOOTER ===== -->
  <footer class="site-footer">
    <p>&copy; 2025 AI assistent. Все права защищены.</p>
  </footer>

  {% include "auth/login.html" %}

  <!-- ===== SCRIPTS ===== -->
  <script src="/static/js/config.js"></script>
  <script src="/static/js/api.js"></script>
  <script src="/static/js/auth.js"></script>

  <script>
    (function(){
      var m = document.getElementById('login-modal');
      if (m && !m.classList.contains('hidden')) m.classList.add('hidden');
    })();

    // мобильное меню и скролл-эффект
    document.addEventListener("DOMContentLoaded", () => {
      const menuToggle = document.getElementById("menuToggle");
      const mainNav = document.getElementById("mainNav");
      if (menuToggle && mainNav) {
        menuToggle.addEventListener("click", (e) => {
          e.preventDefault();
          mainNav.classList.toggle("show");
        });
        mainNav.querySelectorAll("a").forEach(link => {
          link.addEventListener("click", () => {
            mainNav.classList.remove("show");
          });
        });
      }
      const header = document.querySelector(".site-header");
      if (header) {
        window.addEventListener("scroll", () => {
          if (window.scrollY > 0) {
            header.classList.add("scrolled");
          } else {
            header.classList.remove("scrolled");
          }
        });
      }
    });
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>
