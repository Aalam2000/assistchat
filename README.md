# ğŸ“‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° `assistchat`

```text
assistchat/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml              # CI/CD workflow
â”‚
â”œâ”€â”€ branding/                       # Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ², Ğ±Ñ€ĞµĞ½Ğ´-Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹
â”‚   â””â”€â”€ style_profile.md
â”‚
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ app/
â”‚       â””â”€â”€ Dockerfile              # Docker-Ğ¾Ğ±Ñ€Ğ°Ğ· Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
â”‚
â”œâ”€â”€ scripts/                        # Python-ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (seed, Ğ¾Ğ½Ğ±Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ³, Ğ»Ğ¾Ğ³Ğ³ĞµÑ€, Ñ€ĞµÑĞ¿Ğ¾Ğ½Ğ´ĞµÑ€)
â”‚   â”œâ”€â”€ create_user.py
â”‚   â”œâ”€â”€ seed_tg_account.py
â”‚   â”œâ”€â”€ onboard_tg_session.py
â”‚   â”œâ”€â”€ tg_user_dm_logger.py
â”‚   â””â”€â”€ tg_user_dm_responder.py
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ alembic/                    # ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ±Ğ°Ğ·Ñ‹
â”‚   â”‚   â”œâ”€â”€ versions/
â”‚   â”‚   â””â”€â”€ env.py
â”‚   â”œâ”€â”€ app/                       # Ğ’ĞµĞ±-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (API, Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸)
â”‚   â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”‚   â””â”€â”€ mess.js
â”‚   â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ main.py
â”‚   â”‚   â””â”€â”€ models.py
â”‚   â”‚
â”‚   â”œâ”€â”€ common/                     # ĞĞ±Ñ‰Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ (config, DB)
â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â””â”€â”€ db.py
â”‚   â”‚
â”‚   â”œâ”€â”€ integrations/               # Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ (Telegram, OpenAI Ğ¸ Ğ´Ñ€.)
â”‚   â”‚   â””â”€â”€ telegram_client.py
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                     # SQLAlchemy-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”‚   â”œâ”€â”€ tg_account.py
â”‚   â”‚   â””â”€â”€ message.py
â”‚   â”‚
â”‚   â”œâ”€â”€ observability/              # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ logging.py
â”‚   â”‚   â””â”€â”€ metrics.py
â”‚   â”‚
â”‚   â”œâ”€â”€ runners/                    # Ğ¢Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° (Ğ±Ğ¾Ñ‚Ñ‹ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹)
â”‚   â”‚   â”œâ”€â”€ run_tg_dm.py
â”‚   â”‚   â””â”€â”€ run_web.py
â”‚   â”‚
â”‚   â””â”€â”€ runtime/                    # Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°: Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹, ÑĞ·Ñ‹Ğº, Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
â”‚       â”œâ”€â”€ language.py
â”‚       â”œâ”€â”€ memory.py
â”‚       â””â”€â”€ message_handler.py
â”‚
â””â”€â”€ tests/                          # ĞĞ²Ñ‚Ğ¾Ñ‚ĞµÑÑ‚Ñ‹
    â”œâ”€â”€ test_api.py
    â””â”€â”€ test_tg.py
```

---

## ğŸ”¹ ĞšÑ€Ğ°Ñ‚ĞºĞ¾ Ğ¿Ğ¾ ÑĞ»Ğ¾ÑĞ¼

- **scripts/** â†’ Python-ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (seed, Ğ¾Ğ½Ğ±Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ³, Ğ»Ğ¾Ğ³Ğ³ĞµÑ€, Ñ€ĞµÑĞ¿Ğ¾Ğ½Ğ´ĞµÑ€).  
- **src/app/** â†’ Ğ²ĞµĞ±-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (API, Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸).  
- **src/common/** â†’ Ğ¾Ğ±Ñ‰Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ (config, DB).  
- **src/integrations/** â†’ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ (Telegram, OpenAI).  
- **src/models/** â†’ SQLAlchemy-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ (`tg_account`, `message`).  
- **src/observability/** â†’ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸.  
- **src/runners/** â†’ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° (Ğ±Ğ¾Ñ‚ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹).  
- **src/runtime/** â†’ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°: Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹, ÑĞ·Ñ‹Ğº, Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ.  
- **alembic/** â†’ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ±Ğ°Ğ·Ñ‹.  
- **branding/** â†’ ÑÑ‚Ğ¸Ğ»Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ².  
- **docker/** â†’ Dockerfile.  


---

# assistchat - ĞŸĞĞ”Ğ¡ĞšĞĞ—ĞšĞ˜

**1ï¸âƒ£ ĞŸĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ° Ñ Ğ½ÑƒĞ»Ñ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº**

```bash
     cd /var/www/assistchat
     docker compose down --remove-orphans
     docker compose up -d --build
```
**Ğ•ÑĞ»Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ğ» Ğ² Ñ„Ğ¾Ğ½Ğµ**
```bash
     docker compose up -d
```
** Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ²ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ ÑÑ€Ğ°Ğ·Ñƒ
```bash
     docker compose logs -f
```
** Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
```bash
     docker compose logs -f tg_user
```

* `--remove-orphans` ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ Ğ»Ğ¸ÑˆĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… Ğ½ĞµÑ‚ Ğ² `docker-compose.yml`.
* `--build` Ğ¿ĞµÑ€ĞµÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¾Ğ±Ñ€Ğ°Ğ·Ñ‹ Ğ¿Ğ¾ Dockerfile.

---

**2ï¸âƒ£ ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº Ğ±ĞµĞ· Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¸**

```bash
     cd /var/www/assistchat
     docker compose restart
```

---

**3ï¸âƒ£ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²**

```bash
     cd /var/www/assistchat
     docker compose down
```
* Ğ­Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ Ğ¸ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹, Ğ½Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ğ·Ñ‹ Ğ¸ volume'Ñ‹.

---

**4ï¸âƒ£ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°**

```bash
     cd /var/www/assistchat
     docker compose ps
```

**5ï¸âƒ£ ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ²**

```bash
     docker compose logs -f
     docker compose logs -f api
```
**5ï¸âƒ£ ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ‚Ğ¾Ğ¼Ğ° !**
```bash
     docker volume ls
```
---

### ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Postgres)

Ğ”Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Postgres Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ SQL Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ psql:

**Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ñ Postgres**
```bash
    docker exec -it assistchat-db-1 psql -U postgres -d assistchat
```
**ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**
```bash
     \dt
```
**ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑÑ…ĞµĞ¼Ñƒ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ (ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° + Ñ‚Ğ¸Ğ¿Ñ‹ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ¾Ğ²)**
```bash
     \d Ğ¸Ğ¼Ñ_Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
```
**ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**
```bash
     \l
```
**ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ½Ğ° Ğ´Ñ€ÑƒĞ³ÑƒÑ Ğ±Ğ°Ğ·Ñƒ**
```bash
     \c Ğ¸Ğ¼Ñ_Ğ±Ğ°Ğ·Ñ‹
```
**Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ SQL-Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ğ²Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 10 ÑÑ‚Ñ€Ğ¾Ğº Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ tg_account)**
```bash
    SELECT * FROM tg_account LIMIT 10;
```
**Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· psql**
```bash
     \q
```
---

alembic_version
messages
updates_seen
tg_accounts
