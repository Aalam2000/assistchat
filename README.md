# üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ `assistchat`


---

## üß† **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ AssistChat ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ**

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (—Ä–µ—Å—É—Ä—Å–æ–≤) —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

---

### **1Ô∏è‚É£ –û–±—â–∞—è –ª–æ–≥–∏–∫–∞**

* **index.html** ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
* **FastAPI** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π backend.
* –í—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º (Docker), –¥–µ–ø–ª–æ–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Git.

---

### **2Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏**

#### üîπ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ—Ñ–∏–ª—å

* **–õ–æ–≥–∏–Ω / –ª–æ–≥–∞—É—Ç / —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / Google OAuth.**
* –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

  * –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö;
  * –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–π `OpenAI API key` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π;
  * –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã (‚Äúmanaged‚Äù / ‚Äúbyok‚Äù);
  * –≤–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ ‚Äú–±–æ—Ç–∞‚Äù.

#### üîπ –ë–æ—Ç

* –£–ø—Ä–∞–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á—ë–Ω –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
* –†–µ–∞–ª–∏–∑—É–µ—Ç –∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (—Ä–µ—Å—É—Ä—Å–æ–≤).

#### üîπ –†–µ—Å—É—Ä—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

* –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Telegram, Zoom –∏ –¥—Ä.) –∂–∏–≤—É—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `resources`.
* –ö–∞–∂–¥—ã–π —Ä–µ—Å—É—Ä—Å –∏–º–µ–µ—Ç:

  * —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É (`resources/{provider}.html`);
  * JS-—Ñ–∞–π–ª (`static/js/resources_*.js`);
  * JSON-—à–∞–±–ª–æ–Ω –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (`meta_json`);
  * API-—Ä–æ—É—Ç—ã (`/api/resource/...`);
* –ù–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–≤–∏–¥–µ–æ—á–∞—Ç, –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç –∏ —Ç.–ø.) –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ –µ–¥–∏–Ω–æ–º—É —à–∞–±–ª–æ–Ω—É.
* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º: **pause / activate / error / ready.**

#### üîπ –û–±—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã (–≤–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

* –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–ª–æ–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  * **QR-–∫–æ–¥ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º** (`/qr`, `/api/qr/build`).
  * –í –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ä–æ–ª–∏–∫–æ–≤ –∏ —Ç.–¥.

---

### **3Ô∏è‚É£ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

```
src/app/
‚îú‚îÄ‚îÄ main.py                 # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (FastAPI + –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π)
‚îú‚îÄ‚îÄ main_legacy.py          # —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ (–¥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è)
‚îÇ
‚îú‚îÄ‚îÄ core/                   # –æ–±—â–µ–µ —è–¥—Ä–æ
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –ø—É—Ç–∏, —Å–µ–∫—Ä–µ—Ç—ã, –±–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ db.py               # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ get_db()
‚îÇ   ‚îú‚îÄ‚îÄ auth.py             # –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ templates.py        # —à–∞–±–ª–æ–Ω—ã –∏ i18n
‚îÇ   ‚îú‚îÄ‚îÄ middleware.py       # —Ç—Ä–µ–π—Å –∑–∞–ø—Ä–æ—Å–æ–≤, —Å–µ—Å—Å–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ routes/                 # –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ø—Ä–æ—Ñ–∏–ª—å)
‚îÇ   ‚îú‚îÄ‚îÄ auth_routes.py
‚îÇ   ‚îú‚îÄ‚îÄ profile_routes.py
‚îÇ
‚îú‚îÄ‚îÄ modules/                # –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –±–ª–æ–∫–∏ (QR, Bot –∏ —Ç.–ø.)
‚îÇ   ‚îú‚îÄ‚îÄ qr/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service.py
‚îÇ   ‚îî‚îÄ‚îÄ bot/
‚îÇ       ‚îú‚îÄ‚îÄ router.py
‚îÇ       ‚îî‚îÄ‚îÄ manager.py
‚îÇ
‚îú‚îÄ‚îÄ resources/              # –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã)
‚îÇ   ‚îú‚îÄ‚îÄ telegram/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram.html
‚îÇ   ‚îî‚îÄ‚îÄ zoom/
‚îÇ       ‚îú‚îÄ‚îÄ router.py
‚îÇ       ‚îú‚îÄ‚îÄ service.py
‚îÇ       ‚îú‚îÄ‚îÄ schema.json
‚îÇ       ‚îî‚îÄ‚îÄ zoom.html
‚îÇ
‚îú‚îÄ‚îÄ templates/              # HTML
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ profile.html
‚îÇ   ‚îú‚îÄ‚îÄ qr.html
‚îÇ   ‚îú‚îÄ‚îÄ resources.html
‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ       ‚îú‚îÄ‚îÄ telegram.html
‚îÇ       ‚îî‚îÄ‚îÄ zoom.html
‚îÇ
‚îî‚îÄ‚îÄ static/                 # JS, CSS, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

---

### **4Ô∏è‚É£ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã (–ø–æ –ø–æ—Ç–æ–∫–∞–º)**

| –ü–æ—Ç–æ–∫                | –î–µ–π—Å—Ç–≤–∏–µ                            | –û–ø–∏—Å–∞–Ω–∏–µ                              |
| -------------------- | ----------------------------------- | ------------------------------------- |
| **1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**   | `/api/auth/login`, `/auth/google`   | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç; —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–µ—Å—Å–∏—è |
| **2. –ü—Ä–æ—Ñ–∏–ª—å**       | `/profile`, `/api/profile/openai/*` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –≤—ã–±–æ—Ä –∫–ª—é—á–∞ OpenAI         |
| **3. –†–µ—Å—É—Ä—Å—ã**       | `/resources`, `/api/resources/*`    | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏               |
| **4. –ë–æ—Ç**           | `/api/bot/start`, `/api/bot/stop`   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏        |
| **5. –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏** | `/qr`, `/api/qr/build`              | –†–∞–±–æ—Ç–∞ –≤–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏                |

---

### **5Ô∏è‚É£ –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

* **–ò–∑–æ–ª—è—Ü–∏—è:** –∫–∞–∂–¥—ã–π —Ä–µ—Å—É—Ä—Å –∞–≤—Ç–æ–Ω–æ–º–µ–Ω, –µ–≥–æ —Å–±–æ–π –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
* **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:** –Ω–æ–≤—ã–π —Ä–µ—Å—É—Ä—Å = –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞ + schema + router.
* **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –º–∏–Ω–∏–º—É–º —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏, –æ–¥–∏–Ω `main.py` —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å—ë.
* **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:** –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (DB, —à–∞–±–ª–æ–Ω—ã, —Å–µ—Å—Å–∏–∏) —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `core`.

---



# assistchat - –ü–û–î–°–ö–ê–ó–ö–ò 

**1Ô∏è‚É£ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å –Ω—É–ª—è –∏ –∑–∞–ø—É—Å–∫**

```bash
     cd /var/www/assistchat
     docker compose down --remove-orphans
     docker compose up -d --build
```
**–ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏–ª –≤ —Ñ–æ–Ω–µ**
```bash
     docker compose up -d
```
** –°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å—Ä–∞–∑—É
```bash
     docker compose logs -f
```
** –°–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```bash
     docker compose logs -f tg_user
```

* `--remove-orphans` —É–¥–∞–ª—è–µ—Ç –ª–∏—à–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ `docker-compose.yml`.
* `--build` –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã –ø–æ Dockerfile.

---

**2Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏**

```bash
     cd /var/www/assistchat
     docker compose restart
```

---

**3Ô∏è‚É£ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**

```bash
     cd /var/www/assistchat
     docker compose down
```
* –≠—Ç–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏ —É–¥–∞–ª–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç –æ–±—Ä–∞–∑—ã –∏ volume'—ã.

---

**4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞**

```bash
     cd /var/www/assistchat
     docker compose ps
```

**5Ô∏è‚É£ –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**

```bash
     docker compose logs -f
     docker compose logs -f api
```
**5Ô∏è‚É£ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–º–∞ !**
```bash
     docker volume ls
```
---

### üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Postgres)

–î–ª—è –≤—Ö–æ–¥–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Postgres –∏ —Ä–∞–±–æ—Ç—ã —Å SQL –∏—Å–ø–æ–ª—å–∑—É–µ–º psql:

**–í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Postgres**
```bash
    docker exec -it assistchat-db-1 psql -U assistuser -d assistdb
```
**–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã**
```bash
     \dt
```
**–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ö–µ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤)**
```bash
     \d –∏–º—è_—Ç–∞–±–ª–∏—Ü—ã
```
**–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```bash
     \l
```
**–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –±–∞–∑—É**
```bash
     \c –∏–º—è_–±–∞–∑—ã
```
**–í—ã–ø–æ–ª–Ω–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã tg_account)**
```bash
    SELECT * FROM tg_account LIMIT 10;
```
**–í—ã–π—Ç–∏ –∏–∑ psql**
```bash
     \q
```
---

alembic_version
messages
updates_seen
tg_accounts
